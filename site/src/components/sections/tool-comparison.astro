---
import { Icon } from 'astro-icon/components';

interface ToolInfo {
  name: string;
  website: string;
  description: string;
  pros: string[];
  cons: string[];
  bestFor: string;
  ctaLink: string;
  securityStatus: string;
  legalStatus: string;
  contractStatus: string;
}

interface Props {
  category: string;
  tools: string[];
}

const { category, tools } = Astro.props;

const statusOptions = ['未確認', '確認中', '承認済み', '要対応'];

const getRandomStatus = () => statusOptions[Math.floor(Math.random() * statusOptions.length)];

const toolData: { [key: string]: ToolInfo } = {
  "Cursor": {
    name: "Cursor",
    website: "cursor.com",
    description: "AIを活用したコーディング支援機能を持つ次世代IDE",
    pros: ["AIによるコード補完と生成", "GitHubとの統合", "軽量で高速"],
    cons: ["比較的新しいため、機能が限定的", "大規模プロジェクトでの使用実績が少ない"],
    bestFor: "AIの支援を受けながら迅速に開発したい個人開発者や小規模チーム",
    ctaLink: "https://cyberagent3911.zendesk.com/hc/ja/requests/new?ticket_form_id=33319367017241",
    securityStatus: getRandomStatus(),
    legalStatus: getRandomStatus(),
    contractStatus: getRandomStatus(),
  },
  "VSCode": {
    name: "Visual Studio Code",
    website: "code.visualstudio.com",
    description: "Microsoftが開発した無料で多機能なコードエディタ",
    pros: ["豊富な拡張機能", "多言語サポート", "Gitとの優れた統合"],
    cons: ["大規模プロジェクトで少し重くなることがある", "設定の複雑さ"],
    bestFor: "幅広い言語やフレームワークを使用する開発者",
    ctaLink: "https://cyberagent3911.zendesk.com/hc/ja/requests/new?ticket_form_id=33319367017241",
    securityStatus: getRandomStatus(),
    legalStatus: getRandomStatus(),
    contractStatus: getRandomStatus(),
  },
  "GitHub Copilot": {
    name: "GitHub Copilot",
    website: "github.com/copilot",
    description: "AIを使用したコード補完と生成ツール",
    pros: ["高度なコード提案", "多言語サポート", "継続的な学習と改善"],
    cons: ["サブスクリプション形式で有料", "プライバシーの懸念"],
    bestFor: "生産性を大幅に向上させたい経験豊富な開発者",
    ctaLink: "https://cyberagent3911.zendesk.com/hc/ja/requests/new?ticket_form_id=33319367017241",
    securityStatus: getRandomStatus(),
    legalStatus: getRandomStatus(),
    contractStatus: getRandomStatus(),
  },
  "IntelliJ IDEA": {
    name: "IntelliJ IDEA",
    website: "jetbrains.com/idea",
    description: "JetBrainsが開した高機能Java IDE",
    pros: ["強力なコード分析と最適化提案", "優れたデバッグ機能", "豊富な統合ツール"],
    cons: ["有料版は高価", "リソース消費が大きい"],
    bestFor: "Javaを中心とした大規模エンタープライズ開発",
    ctaLink: "https://cyberagent3911.zendesk.com/hc/ja/requests/new?ticket_form_id=33319367017241",
    securityStatus: getRandomStatus(),
    legalStatus: getRandomStatus(),
    contractStatus: getRandomStatus(),
  },
  "JIRA": {
    name: "JIRA",
    website: "atlassian.com/jira",
    description: "Atlassianの包括的なプロジェクト管理ツール",
    pros: ["カスタマイズ性が高い", "アジャイル開発に適している", "他のAtlassian製品との連携"],
    cons: ["学習曲線が急", "大規模チームでは複雑になりがち"],
    bestFor: "アジャイル手法を採用している中〜大規模チーム",
    ctaLink: "https://cyberagent3911.zendesk.com/hc/ja/requests/new?ticket_form_id=33319367017241",
    securityStatus: getRandomStatus(),
    legalStatus: getRandomStatus(),
    contractStatus: getRandomStatus(),
  },
  "Linear": {
    name: "Linear",
    website: "linear.app",
    description: "モダンで高速なプロジェクト管理ツール",
    pros: ["直感的なUI", "高速な操作性", "GitHubとの優れた統合"],
    cons: ["JIRAほど機能が豊富ではない", "大規模プロジェクトでの使用実績が少ない"],
    bestFor: "スタートアップや小〜中規模のソフトウェア開発チーム",
    ctaLink: "https://cyberagent3911.zendesk.com/hc/ja/requests/new?ticket_form_id=33319367017241",
    securityStatus: getRandomStatus(),
    legalStatus: getRandomStatus(),
    contractStatus: getRandomStatus(),
  },
  "Claude": {
    name: "Claude",
    website: "claude.ai",
    description: "高度なAIアシスタント",
    pros: ["高度な自然言語理解", "迅速な応答", "多言語サポート"],
    cons: ["有料サービス", "学習曲線がある"],
    bestFor: "AIを活用したタスク自動化や情報検索に興味のあるユーザー",
    ctaLink: "https://cyberagent3911.zendesk.com/hc/ja/requests/new?ticket_form_id=33319367017241",
    securityStatus: getRandomStatus(),
    legalStatus: getRandomStatus(),
    contractStatus: getRandomStatus(),
  },
  "Genspark": {
    name: "Genspark",
    website: "genspark.com",
    description: "AI検索エンジン",
    pros: ["高度な検索機能", "迅速な結果提供", "多言語サポート"],
    cons: ["有料サービス", "学習曲線がある"],
    bestFor: "高度な検索要件を持つユーザー",
    ctaLink: "https://cyberagent3911.zendesk.com/hc/ja/requests/new?ticket_form_id=33319367017241",
    securityStatus: getRandomStatus(),
    legalStatus: getRandomStatus(),
    contractStatus: getRandomStatus(),
  },
  "Dify": {
    name: "Dify",
    website: "dify.ai",
    description: "ビジュアルAIエージェントビルダー",
    pros: ["ユーザーフレンドリーなインターフェース", "迅速な実装", "多言語サポート"],
    cons: ["有料サービス", "学習曲線がある"],
    bestFor: "AIエージェントの実装に興味のあるユーザー",
    ctaLink: "https://cyberagent3911.zendesk.com/hc/ja/requests/new?ticket_form_id=33319367017241",
    securityStatus: getRandomStatus(),
    legalStatus: getRandomStatus(),
    contractStatus: getRandomStatus(),
  },
};

// Filter out any tools that don't exist in toolData
const validTools = tools.filter(toolName => toolName in toolData);
---

<section class="bg-white py-20">
  <div class="container mx-auto">
    <h2 class="text-3xl font-bold text-center mb-12">{category}ツール比較</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {validTools.map(toolName => {
        const tool = toolData[toolName];
        return (
          <div class="bg-gray-100 rounded-lg p-6 shadow-md">
            <div class="flex items-center mb-4">
              <img src={`https://cdn.brandfetch.io/${tool.website}/w/400/h/400`} alt={tool.name} width="32" height="32" class="mr-3" />
              <h3 class="text-xl font-semibold">{tool.name}</h3>
            </div>
            <p class="text-gray-600 mb-4">{tool.description}</p>
            <h4 class="font-semibold mb-2">長所:</h4>
            <ul class="list-disc list-inside mb-4">
              {tool.pros.map(pro => (
                <li class="text-sm text-gray-600">{pro}</li>
              ))}
            </ul>
            <h4 class="font-semibold mb-2">短所:</h4>
            <ul class="list-disc list-inside mb-4">
              {tool.cons.map(con => (
                <li class="text-sm text-gray-600">{con}</li>
              ))}
            </ul>
            <p class="text-sm text-gray-800 mb-4"><span class="font-semibold">最適な用途:</span> {tool.bestFor}</p>
            <div class="mb-4">
              <p class="text-sm"><span class="font-semibold">セキュリティチェック:</span> <span class={`px-2 py-1 rounded ${tool.securityStatus === '承認済み' ? 'bg-green-200 text-green-800' : 'bg-yellow-200 text-yellow-800'}`}>{tool.securityStatus}</span></p>
              <p class="text-sm"><span class="font-semibold">法務チェック:</span> <span class={`px-2 py-1 rounded ${tool.legalStatus === '承認済み' ? 'bg-green-200 text-green-800' : 'bg-yellow-200 text-yellow-800'}`}>{tool.legalStatus}</span></p>
              <p class="text-sm"><span class="font-semibold">契約ステータス:</span> <span class={`px-2 py-1 rounded ${tool.contractStatus === '承認済み' ? 'bg-green-200 text-green-800' : 'bg-yellow-200 text-yellow-800'}`}>{tool.contractStatus}</span></p>
            </div>
            <div class="flex justify-between items-center">
              <a href={`/tool/${toolName.toLowerCase()}`} class="text-blue-600 hover:text-blue-800 font-semibold">
                詳細を見る →
              </a>
              <a href={tool.ctaLink} class="bg-blue-600 text-white hover:bg-blue-700 font-semibold py-2 px-4 rounded-full transition duration-300 flex items-center">
                <Icon name="heroicons:clipboard-document-list" class="w-5 h-5 mr-2" />
                利用申請する
              </a>
            </div>
          </div>
        );
      })}
    </div>
  </div>
</section>